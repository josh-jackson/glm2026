<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>GLM 2026 - Diagnostics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">GLM 2026</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./lectures.html" rel="" target="">
 <span class="menu-text">Lectures</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./homework.html" rel="" target="">
 <span class="menu-text">homework</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./syllabus.html" rel="" target="">
 <span class="menu-text">Syllabus</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#today" id="toc-today" class="nav-link active" data-scroll-target="#today">Today</a></li>
  <li><a href="#blue" id="toc-blue" class="nav-link" data-scroll-target="#blue">BLUE</a></li>
  <li><a href="#assumptions-of-regression" id="toc-assumptions-of-regression" class="nav-link" data-scroll-target="#assumptions-of-regression">Assumptions of regression</a></li>
  <li><a href="#what-happens-if-we-violate-assumptions" id="toc-what-happens-if-we-violate-assumptions" class="nav-link" data-scroll-target="#what-happens-if-we-violate-assumptions">What happens if we violate assumptions?</a></li>
  <li><a href="#residuals" id="toc-residuals" class="nav-link" data-scroll-target="#residuals">Residuals</a></li>
  <li><a href="#what-are-residuals" id="toc-what-are-residuals" class="nav-link" data-scroll-target="#what-are-residuals">What are residuals?</a></li>
  <li><a href="#measurement-error" id="toc-measurement-error" class="nav-link" data-scroll-target="#measurement-error">1. Measurement Error</a></li>
  <li><a href="#reliability-can-help" id="toc-reliability-can-help" class="nav-link" data-scroll-target="#reliability-can-help">Reliability Can Help!</a></li>
  <li><a href="#form" id="toc-form" class="nav-link" data-scroll-target="#form">2. Form</a></li>
  <li><a href="#model" id="toc-model" class="nav-link" data-scroll-target="#model">3. Model</a></li>
  <li><a href="#model-1" id="toc-model-1" class="nav-link" data-scroll-target="#model-1">3. Model</a></li>
  <li><a href="#lessons-from-lynam-et-al.-2006" id="toc-lessons-from-lynam-et-al.-2006" class="nav-link" data-scroll-target="#lessons-from-lynam-et-al.-2006">Lessons from [Lynam et al., 2006]</a></li>
  <li><a href="#model-2" id="toc-model-2" class="nav-link" data-scroll-target="#model-2">3. Model</a></li>
  <li><a href="#endogeniety" id="toc-endogeniety" class="nav-link" data-scroll-target="#endogeniety">Endogeniety</a></li>
  <li><a href="#condition-on-a-collider" id="toc-condition-on-a-collider" class="nav-link" data-scroll-target="#condition-on-a-collider">Condition on a collider</a></li>
  <li><a href="#homoscedasticity" id="toc-homoscedasticity" class="nav-link" data-scroll-target="#homoscedasticity">4. Homoscedasticity</a></li>
  <li><a href="#homoscedasticity-1" id="toc-homoscedasticity-1" class="nav-link" data-scroll-target="#homoscedasticity-1">4. Homoscedasticity</a></li>
  <li><a href="#independence-among-the-errors" id="toc-independence-among-the-errors" class="nav-link" data-scroll-target="#independence-among-the-errors">5. Independence among the errors</a></li>
  <li><a href="#normality-of-the-errors" id="toc-normality-of-the-errors" class="nav-link" data-scroll-target="#normality-of-the-errors">6. Normality of the errors</a></li>
  <li><a href="#normality-of-the-errors-1" id="toc-normality-of-the-errors-1" class="nav-link" data-scroll-target="#normality-of-the-errors-1">6. Normality of the errors</a></li>
  <li><a href="#robustness" id="toc-robustness" class="nav-link" data-scroll-target="#robustness">Robustness</a></li>
  <li><a href="#screening-your-data" id="toc-screening-your-data" class="nav-link" data-scroll-target="#screening-your-data">Screening your data</a></li>
  <li><a href="#screening-your-data-1" id="toc-screening-your-data-1" class="nav-link" data-scroll-target="#screening-your-data-1">Screening your data</a></li>
  <li><a href="#screening-your-data-2" id="toc-screening-your-data-2" class="nav-link" data-scroll-target="#screening-your-data-2">Screening your data</a></li>
  <li><a href="#screening-your-data-3" id="toc-screening-your-data-3" class="nav-link" data-scroll-target="#screening-your-data-3">Screening your data</a></li>
  <li><a href="#outliers" id="toc-outliers" class="nav-link" data-scroll-target="#outliers">Outliers</a></li>
  <li><a href="#leverage" id="toc-leverage" class="nav-link" data-scroll-target="#leverage">Leverage</a></li>
  <li><a href="#outliers-1" id="toc-outliers-1" class="nav-link" data-scroll-target="#outliers-1">Outliers</a></li>
  <li><a href="#outliers-2" id="toc-outliers-2" class="nav-link" data-scroll-target="#outliers-2">Outliers</a></li>
  <li><a href="#outliers-3" id="toc-outliers-3" class="nav-link" data-scroll-target="#outliers-3">Outliers</a></li>
  <li><a href="#distance" id="toc-distance" class="nav-link" data-scroll-target="#distance">Distance</a></li>
  <li><a href="#outliers-4" id="toc-outliers-4" class="nav-link" data-scroll-target="#outliers-4">Outliers</a></li>
  <li><a href="#outliers-5" id="toc-outliers-5" class="nav-link" data-scroll-target="#outliers-5">Outliers</a></li>
  <li><a href="#cooks-distance" id="toc-cooks-distance" class="nav-link" data-scroll-target="#cooks-distance">Cook’s Distance</a></li>
  <li><a href="#recommendations" id="toc-recommendations" class="nav-link" data-scroll-target="#recommendations">Recommendations</a></li>
  <li><a href="#multicollinearity" id="toc-multicollinearity" class="nav-link" data-scroll-target="#multicollinearity">Multicollinearity</a></li>
  <li><a href="#addressing-multicollinearity" id="toc-addressing-multicollinearity" class="nav-link" data-scroll-target="#addressing-multicollinearity">Addressing Multicollinearity</a></li>
  <li><a href="#suppression" id="toc-suppression" class="nav-link" data-scroll-target="#suppression">Suppression</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="diagnostics.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Diagnostics</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="today" class="level2">
<h2 class="anchored" data-anchor-id="today">Today</h2>
<ul>
<li>Assumptions of GLM regression models</li>
<li>Diagnostics (checking those assumptions)</li>
</ul>
</section>
<section id="blue" class="level2">
<h2 class="anchored" data-anchor-id="blue">BLUE</h2>
<p><strong>B</strong>est <strong>L</strong>inear <strong>U</strong>nbiased <strong>E</strong>stimate of beta <span class="math inline">\((\beta)\)</span></p>
<ul>
<li>Unbiased</li>
<li>Efficient</li>
<li>Consistent</li>
</ul>
</section>
<section id="assumptions-of-regression" class="level2">
<h2 class="anchored" data-anchor-id="assumptions-of-regression">Assumptions of regression</h2>
<ol type="1">
<li><p>No measurement error</p></li>
<li><p>Correctly specified form</p></li>
<li><p>No omitted variables</p></li>
<li><p>Homoscedasticity</p></li>
<li><p>Independence among the residuals</p></li>
<li><p>Normally distributed residuals</p></li>
</ol>
</section>
<section id="what-happens-if-we-violate-assumptions" class="level2">
<h2 class="anchored" data-anchor-id="what-happens-if-we-violate-assumptions">What happens if we violate assumptions?</h2>
<ol type="1">
<li><p><em>Biased</em> regression <strong>coefficients</strong></p></li>
<li><p><em>Biased</em> <strong>standard errors</strong></p></li>
</ol>
<hr>
<table class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 22%">
<col style="width: 27%">
</colgroup>
<thead>
<tr class="header">
<th>Violated Regression Assumption</th>
<th>Coefficients</th>
<th>Standard Errors</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1. Measured without error</td>
<td>Biased</td>
<td>Biased</td>
</tr>
<tr class="even">
<td>2. Correctly specified form</td>
<td>Biased</td>
<td>Biased</td>
</tr>
<tr class="odd">
<td>3. Correctly specified model</td>
<td>Biased</td>
<td>Biased</td>
</tr>
<tr class="even">
<td>4. Homoscedasticity</td>
<td></td>
<td>Biased</td>
</tr>
<tr class="odd">
<td>5. Independent Errors</td>
<td></td>
<td>Biased</td>
</tr>
<tr class="even">
<td>6. Normality of the Errors</td>
<td></td>
<td>Biased</td>
</tr>
</tbody>
</table>
<hr>
<table class="table">
<colgroup>
<col style="width: 49%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Assumption</th>
<th>Detection</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1. Measured without error</td>
<td>Reliability</td>
</tr>
<tr class="even">
<td>2. Correctly specified form</td>
<td>Residuals against predicted</td>
</tr>
<tr class="odd">
<td>3. Correctly specified model</td>
<td>Theory, endogeneity test</td>
</tr>
<tr class="even">
<td>4. Homoscedasticity</td>
<td>Residuals against predicted</td>
</tr>
<tr class="odd">
<td>5. Independent Errors</td>
<td>Research Design</td>
</tr>
<tr class="even">
<td>6. Normality of the Errors</td>
<td>q-q plot or distribution</td>
</tr>
</tbody>
</table>
<hr>
<div class="cell" data-messages="false">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>a_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">here</span>(<span class="st">"anxiety.csv"</span>))</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(Anxiety <span class="sc">~</span> Support, a_data)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>aug_1<span class="ot">&lt;-</span> <span class="fu">augment</span>(model<span class="fl">.1</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>aug_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 118 × 8
   Anxiety Support .fitted  .resid    .hat .sigma    .cooksd .std.resid
     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
 1   10.2     6.16    8.68  1.51   0.0137    2.10 0.00366        0.725 
 2    5.59    8.91    7.54 -1.95   0.00850   2.09 0.00376       -0.937 
 3    6.58   10.5     6.86 -0.278  0.0111    2.10 0.000100      -0.134 
 4    8.95   11.5     6.48  2.47   0.0144    2.09 0.0103         1.19  
 5    7.60    5.55    8.93 -1.33   0.0165    2.10 0.00346       -0.642 
 6    8.16    7.51    8.12  0.0368 0.00966   2.10 0.00000153     0.0177
 7    9.08    8.56    7.69  1.39   0.00850   2.10 0.00192        0.669 
 8    3.41    4.1     9.53 -6.12   0.0255    2.02 0.115         -2.96  
 9    8.66    5.39    9.00 -0.340  0.0173    2.10 0.000237      -0.164 
10    4.85   13.9     5.47 -0.620  0.0299    2.10 0.00139       -0.301 
# ℹ 108 more rows</code></pre>
</div>
</div>
</section>
<section id="residuals" class="level2">
<h2 class="anchored" data-anchor-id="residuals">Residuals</h2>
<p>Residuals are your best diagnostic tool for assessing your regression model. Not only can they tell you if you’ve violated assumptions, but they can point to specific cases that contribute to the violations. This may help you to:</p>
<ul>
<li>Notice patterns, which may lead you to change your theory</li>
<li>Remove problematic cases</li>
<li>Improve your research design</li>
</ul>
</section>
<section id="what-are-residuals" class="level2">
<h2 class="anchored" data-anchor-id="what-are-residuals">What are residuals?</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggplot2' was built under R version 4.4.3</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(aug_1, <span class="fu">aes</span>(<span class="at">x =</span> Support, <span class="at">y =</span> Anxiety)) <span class="sc">+</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_smooth(method = "lm", se = FALSE, color = "lightgrey") +  # Plot regression slope</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> Support, <span class="at">yend =</span> .fitted), <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span>  <span class="co"># alpha to fade lines</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> .fitted), <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Support Predicting Anxiety"</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Univariate"</span>) <span class="sc">+</span> </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="diagnostics_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="measurement-error" class="level2">
<h2 class="anchored" data-anchor-id="measurement-error">1. Measurement Error</h2>
<p>Assumption 1: No measurement error in our independent variables</p>
<ul>
<li><p>How does measurement error affect our coefficient estimates?</p></li>
<li><p>How does measurement error affect our the standard errors of the coefficients?</p></li>
<li><p>How can we check this assumption?</p></li>
</ul>
</section>
<section id="reliability-can-help" class="level2">
<h2 class="anchored" data-anchor-id="reliability-can-help">Reliability Can Help!</h2>
<p>If there is measurement error, our coefficient estimates will always <em>UNDER</em>-estimate the true parameter. This is because <span class="math display">\[r_{xy} = \rho\sqrt{r_{xx}r_{yy}}\]</span> Measurement error inflates our standard errors, because they add…error</p>
<p>There is ALWAYS measurement error. What do we do about this?</p>
</section>
<section id="form" class="level2">
<h2 class="anchored" data-anchor-id="form">2. Form</h2>
<p>Assumption 2: Correctly specified form</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="diagnostics_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>Don’t use linear models on non-linear data! This will underestimate <span class="math inline">\(R^2\)</span></p>
</section>
<section id="model" class="level2">
<h2 class="anchored" data-anchor-id="model">3. Model</h2>
<p>Assumption 3: Correctly specified model - This is especially important for multiple regression.</p>
<ul>
<li>Two problems:</li>
</ul>
<blockquote class="blockquote">
<p>“Over control” and your coefficient is no longer interpretable</p>
</blockquote>
<blockquote class="blockquote">
<p>“Under control” and your coefficient is no longer interpretable</p>
</blockquote>
</section>
<section id="model-1" class="level2">
<h2 class="anchored" data-anchor-id="model-1">3. Model</h2>
<blockquote class="blockquote">
<p>“Over control” and your coefficient is no longer interpretable</p>
</blockquote>
<p>Cohen and Cohen (1983) discuss several problems associated with the inclusion of covariates/multiple independent predictors in a model. Those problems were:</p>
<ol type="1">
<li>Computational accuracy (not a problem now, because computers)</li>
<li>Sampling stability (tolerance)</li>
<li>Interpretation</li>
</ol>
<hr>
<blockquote class="blockquote">
<p>“Over control” and your coefficient is no longer interpretable</p>
</blockquote>
<p>Including multiple predictors in your model requires adjusting for the overlap in these predictors.</p>
<p><span class="math display">\[se_{b} = \frac{s_{Y}}{s_{X}}\sqrt{\frac {1-R_{Y\hat{Y}}^2}{n-p-1}}\sqrt{\frac{1}{1-R_{12}^2}}\]</span></p>
<p>Tolerance (in a two-predictor regression) is:</p>
<p><span class="math display">\[1-R_{12}^2\]</span></p>
<hr>
<p>If your two independent predictors are highly correlated, tolerance gets smaller.</p>
<ul>
<li>As tolerance gets smaller, the standard error gets larger. This is referred to as <em>variance inflation</em>. The <strong>variance inflation factor</strong> is an index to assess this problem.</li>
</ul>
<p><span class="math display">\[\text{VIF} = \frac{1}{\text{Tolerance}} = \frac{1}{1-R^2_{12}}\]</span></p>
<ul>
<li>As the standard error becomes larger, the CIs around coefficients becomes larger. When CIs around estimates are large, then we say the coefficients are <em>unstable.</em></li>
</ul>
<hr>
<p>VIF is not bounded, but generally large numbers (greater than 5 or 10, based on who’s giving you the heuristic) indicates a problem.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(Anxiety <span class="sc">~</span> Support <span class="sc">+</span> Stress, a_data)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(model<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Support   Stress 
1.378785 1.378785 </code></pre>
</div>
</div>
<p>The lesson from tolerance is that, as you add predictors to your model, it is best to select predictors that are not correlated or minimally correlated with each other.</p>
<p>What about interpretation?</p>
<hr>
<ul>
<li><p>What construct does an independent variable represent once the shared variance with other constructs has been removed?</p></li>
<li><p>Partialling changes the meaning and interpretation of a variable.</p></li>
<li><p>Partialling only takes variance away from the reliable <span class="math inline">\((r_{xx})\)</span> part of a measurement.</p>
<ul>
<li>If a scale has reliability .7 and correlates with another variable at .3, the partialling out the covariate removes .3 of the valid .7 variance or 9% out of 49%</li>
</ul></li>
</ul>
<p>[<a href="../readings/Lynam-2006-Assessment.pdf">Lynam et al., 2016</a>]</p>
</section>
<section id="lessons-from-lynam-et-al.-2006" class="level2">
<h2 class="anchored" data-anchor-id="lessons-from-lynam-et-al.-2006">Lessons from [Lynam et al., 2006]</h2>
<ul>
<li><p>Heterogeneous measures run the risk of greater dissimilarity following partialling. They showed this empirically.</p></li>
<li><p>partialling out sub-scales – some correlations are even negative</p></li>
<li><p><strong>Nothing is a good substitute for good theory and reliable measurement.</strong></p></li>
<li><p>Always present zero-order correlations.</p></li>
</ul>
</section>
<section id="model-2" class="level2">
<h2 class="anchored" data-anchor-id="model-2">3. Model</h2>
<p>Assumption 3: Correctly specified model - This is especially important for multiple regression.</p>
<ul>
<li>Two problems:</li>
</ul>
<blockquote class="blockquote">
<p>“Over control” and your coefficient is no longer interpretable</p>
</blockquote>
<blockquote class="blockquote">
<p><strong>“Under control” and your coefficient is no longer interpretable </strong></p>
</blockquote>
</section>
<section id="endogeniety" class="level2">
<h2 class="anchored" data-anchor-id="endogeniety">Endogeniety</h2>
<blockquote class="blockquote">
<p>“Under control” and your coefficient is no longer interpretable</p>
</blockquote>
<p><strong>Endogeniety</strong> is when your your error term is associated with a predictor.</p>
<ul>
<li>Typically when you leave out an important predictor.</li>
</ul>
<hr>
<p>If this is the true model:</p>
<p><span class="math display">\[Y_i = b_0 + b_{1}X_{1} + b_{2}X_{2} + \epsilon_{i}\]</span> But you only model this:</p>
<p><span class="math display">\[Y_i = b_0 + b_{1}X_{1} + \epsilon_{i}\]</span></p>
<p>The extra term is absorbed into the error so that</p>
<p><span class="math display">\[Y_i = b_0 + b_{1}X_{1} + (\epsilon_{i} + X_2)\]</span></p>
<p>If <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> are correlated, and <span class="math inline">\(X_2\)</span> is associated with <span class="math inline">\(Y_i\)</span> above and beyond <span class="math inline">\(X_1\)</span>, then the residual and predictor in the model you ran will be correlated! ( <span class="math inline">\(r_{x_1,\epsilon} \neq 0\)</span> )</p>
</section>
<section id="condition-on-a-collider" class="level2">
<h2 class="anchored" data-anchor-id="condition-on-a-collider">Condition on a collider</h2>
<p>Many ways this can happen but one common one is selecting a sample (clinical students, college students) that is associated with your variables of interest (e.g., emotion regulation, memory ability)</p>
<p><img src="collider.png" class="img-fluid"></p>
</section>
<section id="homoscedasticity" class="level2">
<h2 class="anchored" data-anchor-id="homoscedasticity">4. Homoscedasticity</h2>
<p><strong>Homogeneity of variance</strong></p>
<ul>
<li><p>the variance of an outcome is the same across two (or more) groups</p></li>
<li><p>Levene’s test</p></li>
</ul>
<p><strong>Homoscedasticity</strong></p>
<ul>
<li><p>the variance of an outcome is the same across all levels of all continuous predictor variables</p></li>
<li><p>visual inspection of residuals by fitted values</p></li>
</ul>
</section>
<section id="homoscedasticity-1" class="level2">
<h2 class="anchored" data-anchor-id="homoscedasticity-1">4. Homoscedasticity</h2>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> aug_1, <span class="fu">aes</span>(<span class="at">x=</span>.fitted, <span class="at">y=</span>.resid)) <span class="sc">+</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="diagnostics_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="independence-among-the-errors" class="level2">
<h2 class="anchored" data-anchor-id="independence-among-the-errors">5. Independence among the errors</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>aug_1<span class="sc">$</span>ID <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">118</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> aug_1, </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span>ID, <span class="at">y =</span> .resid)) <span class="sc">+</span> </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span>  </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> F) <span class="sc">+</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="diagnostics_files/figure-html/independence-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="normality-of-the-errors" class="level2">
<h2 class="anchored" data-anchor-id="normality-of-the-errors">6. Normality of the errors</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="diagnostics_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<hr>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(model<span class="fl">.1</span>) <span class="sc">+</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="fu">aes</span>(<span class="at">sample =</span> .stdresid)) <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>() <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Q-Q Plot"</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"for Normality of Errors"</span>) <span class="sc">+</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `fortify(&lt;lm&gt;)` was deprecated in ggplot2 4.0.0.
ℹ Please use `broom::augment(&lt;lm&gt;)` instead.
ℹ The deprecated feature was likely used in the ggplot2 package.
  Please report the issue at &lt;https://github.com/tidyverse/ggplot2/issues&gt;.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="diagnostics_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="normality-of-the-errors-1" class="level2">
<h2 class="anchored" data-anchor-id="normality-of-the-errors-1">6. Normality of the errors</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqPlot</span>(model<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="diagnostics_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="960"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  8 84</code></pre>
</div>
</div>
<hr>
<table class="table">
<colgroup>
<col style="width: 47%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="header">
<th>Assumption</th>
<th>Fix</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1. Measured without error</td>
<td>SEM, factor scores, more data, better design</td>
</tr>
<tr class="even">
<td>2. Correctly specified form</td>
<td>Different model</td>
</tr>
<tr class="odd">
<td>3. Correctly specified model</td>
<td>¯<code>\_</code>(ツ)<code>_</code>/¯ &amp; specificity analyses</td>
</tr>
<tr class="even">
<td>4. Homoscedasticity</td>
<td>Bootstraps, WLS, transformations</td>
</tr>
<tr class="odd">
<td>5. Independent Errors</td>
<td>Use different analysis method</td>
</tr>
<tr class="even">
<td>6. Normality of the Errors</td>
<td>Additional IVs, different form</td>
</tr>
</tbody>
</table>
</section>
<section id="robustness" class="level2">
<h2 class="anchored" data-anchor-id="robustness">Robustness</h2>
<p>Regression models are considered <strong>robust</strong> meaning that even when you violate assumptions, you can still use the same models with some safety.</p>
<ul>
<li>E.g., <em>t</em>-tests are robust to violations of normality, because we can fall back on the central limit theorem.</li>
</ul>
<p>Regression is robust to violations of <em>some</em> assumptions, primarily</p>
<ul>
<li>Homoscedasticity</li>
<li>Normality of errors</li>
</ul>
<hr>
<p>There’s also an underlying assumption that our models are developed independent of the data.</p>
<ul>
<li><p>Changing the model based on assumptions does violate the data-model-independence assumption, but it’s unclear how this affects the inferences. In general, it’s a good idea to validate the new model using a new dataset.</p></li>
<li><p>Changing the model based on the significance tests is <em>bad</em> and it’s fairly clear how this affects our inferences.</p></li>
</ul>
</section>
<section id="screening-your-data" class="level2">
<h2 class="anchored" data-anchor-id="screening-your-data">Screening your data</h2>
<ol type="1">
<li>Calculate univariate and bivariate descriptive stats</li>
</ol>
<ul>
<li>Check the min and max to make sure data were entered correctly</li>
<li>Check the class of the variable
<ul>
<li>is your grouping variable a factor or numeric?</li>
</ul></li>
<li>Check for skew or compare the mean and median</li>
<li>Compare correlation matrices with pairwise and listwise deletion for bias in missingness.</li>
<li>Calculate reliability for your scales.</li>
</ul>
</section>
<section id="screening-your-data-1" class="level2">
<h2 class="anchored" data-anchor-id="screening-your-data-1">Screening your data</h2>
<ol start="2" type="1">
<li>Plot univariate and bivariate distributions</li>
</ol>
<ul>
<li><p>Look for skew and outliers</p></li>
<li><p>Check correlation heat maps for expected and unexpected patterns in items</p></li>
</ul>
</section>
<section id="screening-your-data-2" class="level2">
<h2 class="anchored" data-anchor-id="screening-your-data-2">Screening your data</h2>
<ol start="3" type="1">
<li>Test assumptions of your model(s)</li>
</ol>
<ul>
<li>Calculate the VIF of each term</li>
<li>Graph residuals by predictors to check for endogeneity.</li>
<li>Graph residuals by fitted values to check for homoscedasticity.</li>
<li>Graph residuals by ID number (or date, or another variable not in your model) to check for independence.</li>
<li>Graph the distribution of residuals or the Q-Q plot to check for normality.</li>
</ul>
</section>
<section id="screening-your-data-3" class="level2">
<h2 class="anchored" data-anchor-id="screening-your-data-3">Screening your data</h2>
<ol start="4" type="1">
<li>Look for univariate or multivariate <strong>outliers</strong>.</li>
</ol>
<ul>
<li><p>Broadly defined as atypical or highly influential data point(s)</p></li>
<li><p>Due to contamination (e.g.&nbsp;recording error) or accurate observation of a rare case</p></li>
<li><p>Univariate vs.&nbsp;Multivariate</p></li>
</ul>
<p>How do we typically describe or identify outliers?</p>
<hr>
<p>Outliers can be described in terms of three different metrics. Each conveys a sense of the magnitude of outliery-ness the case exhibits. However, some metrics also describe the degree to which your inferences will change:</p>
<ol type="1">
<li>Leverage
<ul>
<li>How unusual is this case from the rest of the cases in terms of predictors?</li>
</ul></li>
<li>Distance
<ul>
<li>How distant is the observed case from the predicted value?</li>
</ul></li>
<li>Influence
<ul>
<li>How much the does regression coefficient change if case were removed?</li>
</ul></li>
</ol>
</section>
<section id="outliers" class="level2">
<h2 class="anchored" data-anchor-id="outliers">Outliers</h2>
<p><strong>Leverage</strong> tells us how far observed values for a case are from mean values on the set of IVs (centroid).</p>
<ul>
<li><p>Not dependent on Y values</p></li>
<li><p>High leverage cases have greater potential to influence regression results</p></li>
</ul>
</section>
<section id="leverage" class="level2">
<h2 class="anchored" data-anchor-id="leverage">Leverage</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">leveragePlots</span>(model<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="diagnostics_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="outliers-1" class="level2">
<h2 class="anchored" data-anchor-id="outliers-1">Outliers</h2>
<p>One common metric for describing leverage is <strong>Mahalanobis Distance</strong>, which is the multidimensional extension of Euclidean distance where vectors are non-orthogonal. Given a set of variables, <span class="math inline">\(\mathbf{X}\)</span> with means <span class="math inline">\(\mathbf{\mu}\)</span> and covariance <span class="math inline">\(\Sigma\)</span>:</p>
<p><span class="math display">\[\large D^2 = (x - \mu)' \Sigma^{-1} (x - \mu)\]</span></p>
</section>
<section id="outliers-2" class="level2">
<h2 class="anchored" data-anchor-id="outliers-2">Outliers</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="fu">colMeans</span>(a_data[<span class="fu">c</span>(<span class="st">"Stress"</span>, <span class="st">"Support"</span>)], <span class="at">na.rm =</span> T)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>cov <span class="ot">=</span> <span class="fu">cov</span>(a_data[<span class="fu">c</span>(<span class="st">"Stress"</span>, <span class="st">"Support"</span>)])</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>MD <span class="ot">=</span> <span class="fu">mahalanobis</span>(<span class="at">x =</span> a_data[,<span class="fu">c</span>(<span class="st">"Stress"</span>, <span class="st">"Support"</span>)], <span class="at">center =</span> m, <span class="at">cov =</span> cov)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>cutoff <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(<span class="at">p =</span> <span class="fl">0.95</span> , <span class="at">df =</span> <span class="fu">ncol</span>(a_data))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>cutoff</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11.0705</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Display observation whose distance greater than cutoff value</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>a_data[MD <span class="sc">&gt;</span> cutoff ,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] id      Anxiety Stress  Support group  
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
</div>
<hr>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(MD), <span class="at">MD =</span> MD) <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> MD)) <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> x, <span class="at">yend =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">"ID"</span>)<span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">12</span>)) <span class="sc">+</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="diagnostics_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="outliers-3" class="level2">
<h2 class="anchored" data-anchor-id="outliers-3">Outliers</h2>
<ul>
<li><p><strong>Distance</strong> is the distance from prediction, or how far a case’s observed value is from its predicted value</p>
<ul>
<li><p>i.e., residual</p></li>
<li><p>In units of Y.</p></li>
</ul></li>
</ul>
<p>What might be problematic at looking at residuals in order to identify outliers?</p>
</section>
<section id="distance" class="level2">
<h2 class="anchored" data-anchor-id="distance">Distance</h2>
<p>Raw residuals come from a model that is influenced by the outliers, making it harder to detect the outliers in the first place. To avoid this issue, it is advisable to examine the <strong>deleted residuals.</strong></p>
<ul>
<li><p>This value represents the distance between the observed value from a predicted value <em>that is calculated from a regression model based on all data except the case at hand</em></p></li>
<li><p>The leave-one-out procedure is often referred to as a “jack-knife” procedure.</p></li>
</ul>
</section>
<section id="outliers-4" class="level2">
<h2 class="anchored" data-anchor-id="outliers-4">Outliers</h2>
<p><strong>Influence</strong> refers to how much a regression equation would change if the extreme case (outlier) is removed.</p>
<p><span class="math inline">\(\text{Influence} = \text{Leverage} \times \text{Distance}\)</span></p>
<p>The most common are:</p>
<ul>
<li>Cook’s Distance (change in model fit)</li>
<li>DFFITS (change in model fit, standardized)</li>
<li>DFBETAS (change in coefficient estimate without the outlier)</li>
</ul>
</section>
<section id="outliers-5" class="level2">
<h2 class="anchored" data-anchor-id="outliers-5">Outliers</h2>
<p><strong>Cook’s Distance</strong> is calculated by removing the <span class="math inline">\(i\)</span>th data point from the model and recalculating the regression. It summarizes how much all the values in the regression model change when the <span class="math inline">\(i\)</span>th observation is removed.</p>
<p><span class="math display">\[CD_i = \frac{\sum_{j=1}^n(\hat{Y}_j-\hat{Y}_{j(1)})^2}{(p+1)MSE}\]</span></p>
</section>
<section id="cooks-distance" class="level2">
<h2 class="anchored" data-anchor-id="cooks-distance">Cook’s Distance</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>aug_1<span class="sc">$</span>ID <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(aug_1)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(aug_1, <span class="fu">aes</span>(<span class="at">x =</span> ID, <span class="at">y =</span> .cooksd)) <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">rownames</span>(aug_1)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="diagnostics_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<hr>
<p><strong>DFFITS</strong> indexes how much the predicted value for a case changes if you remove the case from the equation.</p>
<p><strong>DFBETAs</strong> index how much the estimate for a coefficient changes if you remove a case from the equation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">dffits</span>(model<span class="fl">.2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           1            2            3            4            5            6 
 0.142822222 -0.194364090 -0.026149990  0.133725184 -0.130437196 -0.004986982 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">dfbeta</span>(model<span class="fl">.2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   (Intercept)       Support        Stress
1  0.076047188 -0.0017168702 -0.0083977784
2  0.022146938  0.0045635001 -0.0165118777
3  0.003825565 -0.0004751821 -0.0007221716
4 -0.045340834 -0.0007265234  0.0121830652
5 -0.039420102  0.0065137198 -0.0063488839
6 -0.001418211  0.0001272720 -0.0001032229</code></pre>
</div>
</div>
<hr>
<div class="cell">
<div class="cell-output-display">
<p><img src="diagnostics_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="recommendations" class="level2">
<h2 class="anchored" data-anchor-id="recommendations">Recommendations</h2>
<ul>
<li><p>Analyze data with/without outliers and see how results change</p></li>
<li><p>If you throw out cases you must believe it is not representative of population of interest or have appropriate explanation. You need to be able to <strong>defend your decision</strong> to the readers, your colleagues, and yourself. You also need to tell people what the hell you did</p></li>
<li><p>Don’t throw out data just to be “safe”. Data are hard to collect and outliers are expected!</p></li>
</ul>
</section>
<section id="multicollinearity" class="level2">
<h2 class="anchored" data-anchor-id="multicollinearity">Multicollinearity</h2>
<p><strong>Multicollinearity</strong> occurs when predictor variables are highly related to each other. - This can be a simple relationship, such as when X1 is strongly correlated with X2. This is easy to recognize, interpret, and correct for.</p>
<ul>
<li>Sometimes multicollinearity is difficult to detect, such as when X1 is not strongly correlated with X2, X3, or X4, but the combination of the latter three is a strong predictor of X1.</li>
</ul>
</section>
<section id="addressing-multicollinearity" class="level2">
<h2 class="anchored" data-anchor-id="addressing-multicollinearity">Addressing Multicollinearity</h2>
<p>Increase sample size</p>
<p>Remove a variable from your model.</p>
<p>Composite or factor scores - If variables are highly correlated because they index the same underlying construct, why not just use them to create a more precise measure of that construct?</p>
<ul>
<li>Centering (esp important if your model includes interaction terms)</li>
</ul>
</section>
<section id="suppression" class="level2">
<h2 class="anchored" data-anchor-id="suppression">Suppression</h2>
<p>Multicollinearity is related to suppression. Normally our standardized partial regression coefficients fall between 0 and <span class="math inline">\(r_{Y1}\)</span>. However, it is possible for <span class="math inline">\(b_{Y1}\)</span> to be larger than <span class="math inline">\(r_{Y1}\)</span>. We refer to this phenomenon as <strong>suppression.</strong> * A non-significant <span class="math inline">\(r_{Y1}\)</span> can become a significant <span class="math inline">\(b_{Y1}\)</span> when additional variables are added to the model.</p>
<ul>
<li>A <em>positive</em> <span class="math inline">\(r_{Y1}\)</span> can become a <em>negative</em> and significant <span class="math inline">\(b_{Y1}\)</span>.</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>